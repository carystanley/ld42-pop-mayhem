!function(e){var t={};function s(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(i,a,function(t){return e[t]}.bind(null,a));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){e.exports=s(1)},function(e,t,s){"use strict";s.r(t);var i=class extends Phaser.Scene{constructor(){super({key:"boot"})}create(){this.scene.start("preloader")}};var a=class extends Phaser.Scene{constructor(){super({key:"preloader"})}preload(){this.load.setPath("assets");let e=this.add.graphics();this.load.on("progress",function(t){e.clear(),e.fillStyle(14678523,1),e.fillRect(0,window.innerHeight/2-30,window.innerWidth*t,60)}),this.load.on("complete",function(){e.destroy()}),this.load.image("title","title.png"),this.load.image("title-background","title-background.png"),this.load.image("tiles","tiles.png"),this.load.spritesheet("player","player.png",{frameWidth:24,frameHeight:24}),this.load.tilemapTiledJSON("level1","level1.json"),this.load.image("165","165.png"),this.load.image("165-black","165-black.png"),this.load.audio("pop1",["pop1.mp3","pop1.ogg"]),this.load.audio("pop2",["pop2.mp3","pop2.ogg"])}create(){var e={image:"165",width:8,height:7,chars:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`",charsPerRow:40,spacing:{x:0,y:1}};this.cache.bitmapFont.add("baseFont",Phaser.GameObjects.RetroFont.Parse(this,e)),e=Object.assign({},e,{image:"165-black"}),this.cache.bitmapFont.add("baseFontBlack",Phaser.GameObjects.RetroFont.Parse(this,e)),this.scene.start("play")}};var r=class extends Phaser.Scene{constructor(e){super({key:"title"})}create(){this.add.image(128,110,"title-background");var e=this.add.image(128,60,"title");this.tweens.add({targets:e,y:110,duration:3e3,ease:"Power2"});var t=this.add.bitmapText(85,165,"baseFontBlack","PRESS SPACE");this.tweens.add({targets:t,alpha:0,duration:500,ease:"Power2",yoyo:!0,loop:1e5,ease:function(e){return e>.5?1:0}}),this.input.keyboard.on("keydown_SPACE",function(e){this.scene.start("play")},this)}};class o extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s){super(e,t,s,"player"),e.physics.add.existing(this),e.add.existing(this),this.setDrag(100,0).setMaxVelocity(150,500).setSize(12,17).setOffset(6,7).setCollideWorldBounds(!0),this.cursors=e.input.keyboard.createCursorKeys(),e.anims.create({key:"idle",frames:e.anims.generateFrameNumbers("player",{start:0,end:0}),frameRate:10,repeat:-1}),e.anims.create({key:"jump",frames:e.anims.generateFrameNumbers("player",{start:1,end:1}),frameRate:10,repeat:-1}),e.anims.create({key:"run",frames:e.anims.generateFrameNumbers("player",{start:3,end:8}),frameRate:10,repeat:-1}),this.hurtCount=160,this.jumpTimer=0}update(){const{cursors:e}=this,t=this.body.blocked.down,s=t?300:100;this.hurtCount>0?(this.visible=Math.floor(this.hurtCount/3)%2==0,this.hurtCount--):this.visible=!0,e.left.isDown?(this.setAccelerationX(-s),this.setFlipX(!0)):e.right.isDown?(this.setAccelerationX(s),this.setFlipX(!1)):this.setAccelerationX(0),(t||this.jumpTimer>0)&&e.up.isDown?(t&&(this.jumpTimer=10),this.setAccelerationY(-1100)):this.setAccelerationY(0),this.jumpTimer>0&&this.jumpTimer--,t?0!==this.body.velocity.x?this.anims.play("run",!0):this.anims.play("idle",!0):this.anims.play("jump",!0)}}var n=class extends Phaser.Scene{constructor(e){super({key:"play"})}create(){const e=this.make.tilemap({key:"level1"}),t=e.addTilesetImage("tiles","tiles");e.createDynamicLayer("background",t,0,0);const s=e.createDynamicLayer("world",t,0,0);s.setCollisionByProperty({collides:!0}),this.physics.world.gravity.y=350,this.worldLayer=s;const i=e.findObject("objects",e=>"start"===e.name);this.player=new o(this,i.x,i.y),this.physics.add.collider(this.player,s);const a=e.findObject("objects",e=>"popcorn"===e.name);this.popcornQueue=[{x:Math.floor(a.x/8),y:Math.floor(a.y/8)}],this.goals=this.physics.add.group({classType:Phaser.GameObjects.Zone}),e.filterObjects("objects",function(e){return"goal"===e.type}).forEach(function(e){this.goals.create(e.x,e.y,e.width,e.height).body.allowGravity=!1},this),this.physics.add.overlap(this.player,this.goals,this.onGoal,null,this);const r=this.cameras.main;r.startFollow(this.player),r.setBounds(0,0,e.widthInPixels,e.heightInPixels),r.setDeadzone(40,20),this.physics.world.setBounds(0,0,e.widthInPixels,e.heightInPixels),this.popSounds=[this.sound.add("pop1"),this.sound.add("pop2")],this.playerIsSquashed=!1}update(){this.player.update(),this.isPlayerSquashed()&&this.doPlayerSquashed();let e,t=null;do{(t=this.popcornQueue.shift())&&(e=this.worldLayer.getTileAt(t.x,t.y))}while(t&&e&&e.collides);if(t){const{x:e,y:s}=t;this.popcornLocation(e,s),this.queuePush(e,s+1),this.queuePush(e-1,s),this.queuePush(e+1,s),this.queuePush(e,s-1)}}isPlayerSquashed(){const e=this.player.body,t=e.top,s=e.left,i=e.right,a=e.bottom;return this.doesWorldXYCollide(s,t)&&this.doesWorldXYCollide(s,a)&&this.doesWorldXYCollide(i,t)&&this.doesWorldXYCollide(i,a)}doesWorldXYCollide(e,t){const s=this.worldLayer.getTileAtWorldXY(e,t);return s&&s.collides}queuePush(e,t){const s=this.worldLayer.getTileAt(e,t);s&&s.collides||this.popcornQueue.push({x:e,y:t})}popcornLocation(e,t){this.worldLayer.putTileAt(5,e,t).setCollision(!0)}doPlayerSquashed(){this.playerIsSquashed||(this.playerIsSquashed=!0,this.cameras.main.shake(500),this.time.delayedCall(250,function(){this.cameras.main.fade(250)},[],this),this.time.delayedCall(500,function(){this.scene.start("gameover")},[],this))}playerHitBaddie(){this.player.hurtCount>0||this.gameOver()}onGoal(){this.scene.pause()}};var l=class extends Phaser.Scene{constructor(e){super({key:"gameover"})}create(){this.add.bitmapText(95,40,"baseFont","GAME OVER"),this.add.bitmapText(45,80,"baseFont","BUTTER LUCK NEXT TIME");var e=this.add.bitmapText(35,165,"baseFont","PRESS SPACE TO CONTINUE");this.tweens.add({targets:e,alpha:0,duration:500,ease:"Power2",yoyo:!0,loop:1e5,ease:function(e){return e>.5?1:0}}),this.input.keyboard.on("keydown_SPACE",function(e){this.scene.start("title")},this)}},h={type:Phaser.AUTO,backgroundColor:"#000000",width:256,height:224,physics:{default:"arcade",arcade:{}},scene:[i,a,r,n,l],antialias:!1,pixelArt:!0,callbacks:{postBoot:function(){c()}}},d=new Phaser.Game(h);function c(){const e=d.config.width,t=d.config.height,s=window.innerWidth/e,i=window.innerHeight/t,a=Math.floor(Math.min(s,i));d.canvas&&(d.canvas.style.width=a*e+"px",d.canvas.style.height=a*t+"px")}window.addEventListener("resize",function(){c()},!1)}]);
//# sourceMappingURL=app.js.map